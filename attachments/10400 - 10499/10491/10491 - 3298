@echo off
setlocal enabledelayedexpansion

title 快速设置使用内网http代理服务器
:start
cls
echo.
echo         请选择需要进行的设置：
echo.
echo    1,自动代理   2,全局代理   3,停用代理恢复设置   4,清理临时文件   Q,退出
echo.
set /p choice=      请作出选择:
if /i "%choice%"=="1" goto startauto
if /i "%choice%"=="2" goto start1
if /i "%choice%"=="3" goto stop
if /i "%choice%"=="4" goto deltemp
if /i "%choice%"=="Q" goto end
goto start

:startauto
echo	使用内网http代理自动模式
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v ProxyEnable /t REG_DWORD /d 0 /f
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v AutoConfigURL /d "http://192.168.16.121:8086/proxy.pac" /f
echo     使用内网http代理全局模式成功.
pause
goto start

:start1
echo	使用内网http代理全局模式
reg delete "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v AutoConfigURL /f
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v ProxyServer /d "192.168.16.121:8087" /f
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v ProxyEnable /t REG_DWORD /d 1 /f
echo     使用内网http代理全局模式成功.
pause
goto start

:stop
echo 清除http代理设置
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v ProxyEnable /t REG_DWORD /d 0 /f
reg delete "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v AutoConfigURL /f
echo.
echo     http代理设置已经清除,任意键返回.
pause>nul
goto start

:deltemp
@ECHO OFF
echo 正在清除临时文件，请稍等...... 
del /f /s /q %systemdrive%\*.tmp 
del /f /s /q %systemdrive%\*._mp 
del /f /s /q %systemdrive%\*.log 
del /f /s /q %systemdrive%\*.gid 
del /f /s /q %systemdrive%\*.chk 
del /f /s /q %systemdrive%\*.old 
del /f /s /q %systemdrive%\recycled\*.* 
del /f /s /q %windir%\*.bak 
del /f /s /q %windir%\prefetch\*.* 
rd /s /q %windir%\temp & md %windir%\temp 
del /f /q %userprofile%\cookies\*.* 
del /f /q %userprofile%\recent\*.* 
del /f /s /q "%userprofile%\Local Settings\Temporary Internet Files\*.*" 
del /f /s /q "%userprofile%\Local Settings\Temp\*.*" 
del /f /s /q "%userprofile%\recent\*.*" 
pause
goto start

:end
exit